% Documentație conform template FMI (report, Times, 1.5 line spacing)
% Autori: Ingrid Corobana, Teodora Nae
% Compilare recomandată: xelatex doc_ro_fin.tex

\documentclass[12pt, a4paper]{report}

% Suport pentru diacritice și alte simboluri
\usepackage{fontspec}

% Font Times New Roman
\usepackage{times}

% Suport pentru mai multe limbi
\usepackage{polyglossia}

% Setează limba textului la română
\setdefaultlanguage{romanian}
% Am nevoie de engleză pentru rezumat
\setotherlanguages{english}

% Indentează și primul paragraf al fiecărei noi secțiuni
\SetLanguageKeys{romanian}{indentfirst=true}

% Suport pentru diferite stiluri de ghilimele
\usepackage{csquotes}

\DeclareQuoteStyle{romanian}
  {\quotedblbase}
  {\textquotedblright}
  {\guillemotleft}
  {\guillemotright}

% Setează spațiere inter-linie (doublespacing din LaTeX este echivalentul setarii 1.5 in Microsoft Word)
\usepackage{setspace}
\doublespacing

% Modificarea geometriei paginii (cu margini de 2,5 cm) 
\usepackage[margin=2.5cm]{geometry}

% Include funcțiile de grafică
\usepackage{graphicx}
% Încarcă imaginile din directorul `images`
\graphicspath{{./images/}{../results/ipix_figures/}}

% Pachete matematice
\usepackage{amsmath}
\usepackage{amssymb}

% Algoritmi
\usepackage{algorithm}
\usepackage{algpseudocode}

% Listări de cod
\usepackage{listings}

% Culori
\usepackage{xcolor}

% Linkuri interactive în PDF
\usepackage[
    colorlinks,
    linkcolor={black},
    menucolor={black},
    citecolor={black},
    urlcolor={blue}
]{hyperref}

% Tabele
\usepackage{array}
\usepackage{booktabs}
\usepackage{float}
\usepackage{caption}

% Pentru includerea PDF-urilor
\usepackage{pdfpages}

% Pachete pentru figurile complexe TikZ
\usepackage{tikz}
\usetikzlibrary{arrows.meta,positioning,fit,calc,shadows.blur,backgrounds}

% Stiluri diferite de headere și footere
\usepackage{fancyhdr}

\definecolor{stftblue}{RGB}{66, 133, 244}
\definecolor{cfarorange}{RGB}{255, 152, 0}
\definecolor{dbscangreen}{RGB}{76, 175, 80}
\definecolor{maskpurple}{RGB}{156, 39, 176}
\definecolor{istftred}{RGB}{244, 67, 54}
\definecolor{signalgray}{RGB}{96, 96, 96}
\definecolor{darkblue}{RGB}{25, 50, 100}
\definecolor{codegray}{RGB}{240, 240, 240}

\lstset{
    language=Python,
    basicstyle=\ttfamily\small,
    backgroundcolor=\color{codegray},
    breaklines=true,
    keywordstyle=\color{blue},
    commentstyle=\color{gray},
    stringstyle=\color{red},
    identifierstyle=\color{darkblue},
    numbers=left,
    numberstyle=\tiny\color{gray}
}

\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

% Metadate
\title{Analiza semnalelor radar în prezența sea clutter}
\author{Ingrid Corobana \quad Teodora Nae}

% Generează variabilele cu @
\makeatletter

% Suport pentru rezumat în două limbi
\newenvironment{abstractpage}
  {\cleardoublepage\thispagestyle{empty}}
  {\cleardoublepage}
\renewenvironment{abstract}[1]
  {\bigskip\selectlanguage{#1}%
   \begin{center}\bfseries\abstractname\end{center}}
  {\par\bigskip}

\begin{document}

% ============================================================================
% PAGINA DE TITLU - Format FMI
% ============================================================================
\begin{titlepage}
\newgeometry{left=2cm,right=2cm,top=1.5cm,bottom=1cm}
\begin{singlespace}

\begin{figure}[!htb]
    \centering
    \begin{minipage}{0.18\textwidth}
        \includegraphics[width=\linewidth]{logo-ub.png}
    \end{minipage}
    \begin{minipage}{0.55\textwidth}
        \begin{center}
            \textbf{UNIVERSITATEA DIN BUCUREȘTI}\\[0.2cm]
            \textbf{FACULTATEA DE MATEMATICĂ ȘI INFORMATICĂ}
        \end{center}
    \end{minipage}
    \begin{minipage}{0.18\textwidth}
        \includegraphics[width=\linewidth]{logo-fmi.png}
    \end{minipage}
\end{figure}

\vspace{0.3cm}
\begin{center}
\textbf{Specializarea: Informatică}
\end{center}

\vspace{0.8cm}

\begin{center}
\Large \textbf{Proiect la Procesarea Semnalelor}
\end{center}

\vspace{0.5cm}

\begin{center}
\LARGE \textbf{ANALIZA SEMNALELOR RADAR ÎN PREZENȚA SEA CLUTTER}
\end{center}

\vspace{0.3cm}

\begin{center}
\large Abordare bazată pe CFAR-STFT și experimente pe date sintetice și reale
\end{center}

\vspace{1.5cm}

\begin{center}
\large \textbf{Studenți}\\[0.1cm]
Ingrid Corobana\\
Teodora Nae
\end{center}

\vspace{0.8cm}

\begin{center}
\large \textbf{Coordonator științific}\\[0.1cm]
Prof. Dr. Cristian Rusu
\end{center}

\vspace{1.2cm}

\begin{center}
\small \textbf{Repository GitHub:} \url{https://github.com/dirgnic/Radar_Detection_STFT}
\end{center}

\vspace{0.8cm}

\begin{center}
\Large \textbf{București, 2026}
\end{center}

\end{singlespace}
\end{titlepage}

\restoregeometry
\newgeometry{margin=2.5cm}

% ============================================================================
% PAGINA DE REZUMAT
% ============================================================================
\begin{abstractpage}

\begin{abstract}{romanian}
Acest document prezintă o implementare completă a algoritmului \textbf{CFAR--STFT}, propus de \textbf{Abratkiewicz (2022)}, pentru detecția și reconstrucția semnalelor radar în prezența zgomotului și a sea clutter. Algoritmul combină \textbf{Short-Time Fourier Transform (STFT)}, \textbf{detecție adaptivă CFAR 2D}, \textbf{clustering DBSCAN} și \textbf{dilatare geodezică} pentru a extrage componenta de interes dintr-un amestec cu sea clutter.

Implementarea este validată pe date sintetice (chirp neliniar) și pe date reale (\textbf{IPIX radar}, sea clutter). Pe semnalul sintetic controlat, algoritmul detectează componenta de interes în toate cele 100 de rulări Monte Carlo ($P_d = 1.00$). \textbf{RQF} (Reconstruction Quality Factor) crește de la \textbf{7.28 dB} (SNR = 5 dB) la \textbf{29.17 dB} (SNR = 30 dB).

\textbf{Contribuția principală}: adaptăm algoritmul la sea clutter real folosind \textbf{K-distribution} (în loc de Gaussian), \textbf{îmbunătățire bazată pe proprietăți fractale (exponentul Hurst)} pentru ținte slabe și \textbf{DBSCAN asimetric} pentru clustering de semnături verticale.

\textbf{Cuvinte cheie:} CFAR, STFT, radar, sea clutter, K-distribution, DBSCAN, detecție adaptivă
\end{abstract}

\newpage

\begin{abstract}{english}
This document presents a complete implementation of the \textbf{CFAR-STFT} algorithm, proposed by \textbf{Abratkiewicz (2022)}, for detection and reconstruction of radar signals in the presence of noise and sea clutter. The algorithm combines \textbf{Short-Time Fourier Transform (STFT)}, \textbf{2D adaptive CFAR detection}, \textbf{DBSCAN clustering}, and \textbf{geodesic dilation} to extract the component of interest from a mixture with sea clutter.

The implementation is validated on synthetic data (nonlinear chirp) and real data (\textbf{IPIX radar sea clutter}). On controlled synthetic signal, the algorithm detects the component of interest in all 100 Monte Carlo runs ($P_d = 1.00$). \textbf{RQF} (Reconstruction Quality Factor) increases from \textbf{7.28 dB} (SNR = 5 dB) to \textbf{29.17 dB} (SNR = 30 dB).

\textbf{Key contribution}: we adapt the algorithm to real sea clutter using \textbf{K-distribution} (instead of Gaussian), \textbf{fractal-based enhancement (Hurst exponent)} for weak targets, and \textbf{asymmetric DBSCAN} for vertical signature clustering.

\textbf{Keywords:} CFAR, STFT, radar, sea clutter, K-distribution, DBSCAN, adaptive detection
\end{abstract}

\end{abstractpage}

% ============================================================================
% CUPRINS
% ============================================================================
\tableofcontents

% ============================================================================
% CONFIGURARE PAGINI PRINCIPALE
% ============================================================================
\cleardoublepage
\fancypagestyle{main}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \fancyhead[C]{}
  \fancyfoot[C]{\thepage}
}
\pagestyle{main}

% ============================================================================
% CAPITOLUL 1: INTRODUCERE
% ============================================================================
\chapter{Introducere}

Problema principală pe care o rezolvăm este \textbf{detecția obiectelor mici în date radar maritime}, într-un mediu complex care se schimbă constant din cauza valurilor. Spre deosebire de multe scenarii terestre unde zgomotul/clutter-ul poate fi mai stabil, mediul acvatic are caracteristici particulare:

\begin{itemize}
    \item statisticile \textbf{nu sunt bine modelate Gaussian} (apar valori extreme mai frecvent decât în distribuția normală),
    \item există \textbf{corelație temporală} (valurile creează tipare structurate),
    \item efectele Doppler duc la \textbf{extinderea spectrului} (valuri în mișcare),
    \item apar \textbf{spike-uri} vizibile în spectrograme când valurile sunt mai mari.
\end{itemize}

Metodele tradiționale adaptive de detecție \textbf{CFAR} (Constant False Alarm Rate) pot fi limitate atunci când pierd informația temporală și nu exploatează structura timp--frecvență. Abratkiewicz (2022)\footnote{Abratkiewicz, K. (2022). Radar Detection-Inspired Signal Retrieval from the Short-Time Fourier Transform. Sensors, 22(16), 5954.} propune o abordare care folosește explicit structura \textbf{time--frequency} pentru a îmbunătăți atât \textbf{detecția}, cât și \textbf{recuperarea/reconstrucția} componentelor semnalului.





% ============================================================================
% CAPITOLUL 2: STATE-OF-THE-ART (FUNDAMENTE TEORETICE)
% ============================================================================
\chapter{State-of-the-art și Fundamente}

\section{STFT - Transformata Fourier cu Timp Scurt}

\begin{equation}
X(k,n) = \sum_{m=0}^{N-1} x(m) \cdot w(m - nH) \cdot e^{-j2\pi km/N}
\end{equation}
cu $N=256$, $H=32$ (87.5\% overlap), fereastră Gaussiană $w(m) = e^{-m^2/(2\sigma^2)}$, $\sigma=8$.

\section{CFAR 2D (GOCA-CFAR)}

Detecție adaptivă cu prag local: $H(k,n) = 1$ dacă $|X(k,n)|^2 > T$, unde
\begin{equation}
T = R \cdot \hat{Z}, \quad \hat{Z} = \max(\mu_1, \mu_2, \mu_3, \mu_4), \quad R = N_T (P_f^{-1/N_T} - 1)
\end{equation}

\section{DBSCAN}

Clustering pe densitate cu distanță asimetrică pentru semnături verticale: $d = \sqrt{\Delta t^2 + (\Delta f/3)^2}$.

% ============================================================================
% CAPITOLUL 3: DESCRIEREA ALGORITMULUI
% ============================================================================
\chapter{Descrierea completă a algoritmului}

\section{Pipeline general (5 pași)}

Algoritmul complet are cinci pași:

\begin{enumerate}
    \item calcul STFT cu fereastră Gaussiană;
    \item detecție \textbf{CFAR 2D} în plan timp--frecvență;
    \item clustering DBSCAN al punctelor detectate;
    \item extinderea măștii prin \textbf{dilatare geodezică} (geodesic dilation);
    \item extragere detecții (mascare STFT).
\end{enumerate}

\begin{figure}[H]
\centering
\begin{tikzpicture}[
    node distance=2.2cm and 2.5cm,
    box/.style={rectangle, draw, rounded corners, minimum width=3.2cm, minimum height=1.1cm, align=center, font=\small\bfseries},
    arrow/.style={-{Stealth[length=3mm]}, thick},
    label/.style={font=\scriptsize, align=center},
    eqlabel/.style={font=\tiny, text=gray}
]

% Rândul 1: Input -> STFT -> CFAR
\node[box, fill=signalgray!20] (input) {Semnal de intrare\\$x[n]$};

\node[box, fill=stftblue!30, right=of input] (stft) {STFT\\Gaussiană $\sigma=8$};

\node[box, fill=cfarorange!30, right=of stft] (cfar) {GOCA-CFAR 2D\\$P_f=0.001$};

% Rândul 2: DBSCAN -> Mask -> Detecții
\node[box, fill=dbscangreen!30, below=2cm of cfar] (dbscan) {DBSCAN\\Clustering};

\node[box, fill=maskpurple!30, below=2cm of stft] (mask) {Mask Expansion\\Geodesic Dilation};

\node[box, fill=istftred!30, below=2cm of input] (output) {Detecții\\finale};

% Rândul 3: Output
\node[box, fill=signalgray!20, below=2cm of mask] (final) {Ținte detectate};

% Săgeți rândul 1
\draw[arrow] (input) -- node[above, label] {$x[n]$} (stft);
\draw[arrow] (stft) -- node[above, label] {$|F_x^h|^2$} (cfar);

% Săgeți verticale și rândul 2
\draw[arrow] (cfar) -- node[right, label] {Mască\\binară} (dbscan);
\draw[arrow] (dbscan) -- node[above, label] {Clustere} (mask);
\draw[arrow] (mask) -- node[above, label] {Măști} (output);

% Săgeată finală
\draw[arrow] (output) -- (final);

\end{tikzpicture}
\caption{Pipeline-ul complet al algoritmului CFAR-STFT pentru detecția componentelor din planul timp-frecvență.}
\label{fig:pipeline}
\end{figure}

\subsection{Pasul 2: Structura CFAR 2D}

\begin{figure}[H]
\centering
\begin{tikzpicture}[scale=0.65]
    % Grid background
    \draw[step=1, gray!30, very thin] (-5.5,-5.5) grid (5.5,5.5);
    
    % Training cells (outer ring)
    \fill[cfarorange!40] (-5,-5) rectangle (5,5);
    
    % Guard cells (middle ring)
    \fill[yellow!40] (-3,-3) rectangle (3,3);
    
    % CUT (center)
    \fill[red!60] (-0.5,-0.5) rectangle (0.5,0.5);
    
    % Labels pentru regiuni
    \node at (0,0) {\textbf{CUT}};
    \node at (0,2) {\small Guard};
    \node at (0,4) {\small Training};
    
    % Dimensiuni
    \draw[{Stealth}-{Stealth}, thick] (-5,-6) -- (5,-6);
    \node at (0,-6.5) {$2(N_G + N_T) + 1$};
    
    \draw[{Stealth}-{Stealth}, thick] (-3,-5.3) -- (3,-5.3);
    \node at (0,-5.8) {\scriptsize $2N_G + 1$};
    
    % GOCA regions
    \draw[thick, blue, dashed] (-5,0.5) rectangle (-0.5,5);
    \draw[thick, green!70!black, dashed] (0.5,0.5) rectangle (5,5);
    \draw[thick, purple, dashed] (-5,-5) rectangle (-0.5,-0.5);
    \draw[thick, orange!80!black, dashed] (0.5,-5) rectangle (5,-0.5);
    
    \node[blue, font=\scriptsize] at (-2.75,2.75) {$\mu_1$};
    \node[green!70!black, font=\scriptsize] at (2.75,2.75) {$\mu_2$};
    \node[purple, font=\scriptsize] at (-2.75,-2.75) {$\mu_3$};
    \node[orange!80!black, font=\scriptsize] at (2.75,-2.75) {$\mu_4$};
    
\end{tikzpicture}
\hspace{1cm}
\begin{tikzpicture}[scale=0.85]
    % Formula box
    \node[draw, rounded corners, fill=gray!10, minimum width=5.5cm, minimum height=4cm, align=left] (formulas) {
        \textbf{GOCA-CFAR:}\\[0.3em]
        $\hat{Z} = \max(\mu_1, \mu_2, \mu_3, \mu_4)$\\[0.3em]
        $T = R \cdot \hat{Z}$\\[0.3em]
        $R = N_T \cdot (P_f^{-1/N_T} - 1)$\\[0.8em]
        \textbf{Decizie:}\\[0.3em]
        $|F_x^h[m,k]|^2 \geq T \Rightarrow$ \textcolor{green!60!black}{Det}\\
        $|F_x^h[m,k]|^2 < T \Rightarrow$ \textcolor{red}{Zgomot}
    };
\end{tikzpicture}
\caption{Structura celulelor GOCA-CFAR 2D: CUT (roșu), Guard (galben), Training (portocaliu). GOCA calculează media în 4 sub-regiuni și ia maximul pentru adaptare locală.}
\label{fig:cfar}
\end{figure}

\subsection{Pasul 1: Calcul STFT}

Aplică formula (1) cu $N_{fft}=256$, hop=32, fereastră Gaussiană $\sigma=8$.

\subsection{Pasul 2: Detecție CFAR 2D}

Calculează media puterii în 4 cadrane pentru fiecare bin (k,n), prag $T = R \cdot \max(\mu_1, \mu_2, \mu_3, \mu_4)$, decisie dacă $|X(k,n)|^2 > T$. Parametri: $P_f=0.001$, $N_G=3$, $N_T=12$.\n\n\subsection{Pasul 3: Clustering DBSCAN}

Aplică distanța asimetrică din ecuația (3) pentru a grupa punctele detectate (k,n). Parametri: $\varepsilon=8$, minSamples=5.

\subsection{Pasul 4: Dilatare geodezică}

Aplică dilatare cu kernel cruce (3×3) de 3 ori: \texttt{for i in range(3): H\_dil = scipy.ndimage.maximum\_filter(H\_dil, footprint=cross)}. Expandează detecțiile pentru a conecta punctele apropiate.

\subsection{Pasul 5: Extragere detecții}

Aplică masca pe STFT: \texttt{X\_masked = X\_stft \(\odot\) H\_dil}, apoi extrage binarele detectate.

% ============================================================================
% CAPITOLUL 4: DATE ȘI SURSE DE VALIDARE
% ============================================================================
\chapter{Date și surse de validare}

\section{Baza de date IPIX}

IPIX (McMaster University): radar X-band ($f_{RF}=9.39$ GHz, PRF=1000 Hz), date complexe I/Q. Ținte reale (sferă 1m la 2660m): \#17, \#18, \#30, \#40.

\section{Experimente pe semnale sintetice}

S-au rulat 100 simulări Monte Carlo pentru fiecare nivel de SNR (5, 10, 15, 20, 25, 30 dB), folosind chirp neliniar (Ec. 14). Rata de detecție: 100\% în toate rulările.

Metrica RQF:
\begin{equation}
\text{RQF} = 10 \log_{10}\left(\frac{\sum_n |x[n]|^2}{\sum_n |x[n] - \hat{x}[n]|^2}\right) \text{ [dB]}
\end{equation}

\begin{table}[H]
\centering
\caption{Rezultate CFAR-STFT pe chirp neliniar sintetic -- 100 rulări MC}
\label{tab:results_synthetic}
\begin{tabular}{ccccc}
\toprule
\textbf{SNR [dB]} & \textbf{RQF\_mean [dB]} & \textbf{RQF\_std [dB]} & \textbf{P\_detecție [\%]} & \textbf{N\_rulări} \\
\midrule
5 & 7.28 & 0.47 & 100.0 & 100 \\
10 & 16.81 & 0.60 & 100.0 & 100 \\
15 & 22.95 & 0.56 & 100.0 & 100 \\
20 & 26.40 & 0.51 & 100.0 & 100 \\
25 & 28.43 & 0.39 & 100.0 & 100 \\
30 & 29.17 & 0.25 & 100.0 & 100 \\
\bottomrule
\end{tabular}
\end{table}

\section{Analiză comparativă: Algoritmi CFAR și Clustering}

\subsection{Principii fundamentale CFAR}

Toți algoritmii de tip CFAR (Constant False Alarm Rate) urmează principii comune pentru menținerea ratei alarmelor false la nivel constant în condiții de zgomot variabil:

\begin{itemize}
    \item \textbf{Procesarea prin Fereastră Glisantă:} Analiza spectrogramei cu fereastră mobilă compusă din:
    \begin{enumerate}
        \item \textbf{CUT (Cell Under Test):} Celula centrală evaluată
        \item \textbf{Zona de gardă (Guard Cells):} Celule adiacente neprocesate pentru evitarea scurgerii energiei țintei
        \item \textbf{Celulele de antrenament (Training Cells):} Celule periferice pentru eșantionarea zgomotului local ($Z$)
    \end{enumerate}
    
    \item \textbf{Pragul adaptiv:} Recalculat dinamic: $T = \alpha \cdot Z$ unde $Z$ este puterea zgomotului estimată și $\alpha$ depinde de $P_{fa}$ dorită
    
    \item \textbf{Condiția de detecție:} Dacă puterea în CUT depășește pragul: $CUT \ge T$ → detecție
\end{itemize}

\subsection{Descrierea algoritmilor CFAR testați}

\begin{itemize}
    \item \textbf{CA-CFAR (Cell Averaging):} Estimează nivelul zgomotului prin media aritmetică a celulelor de antrenament. Eficient în zgomot omogen, dar suferă mascare în prezența țintelor multiple.
    
    \item \textbf{OS-CFAR (Ordered Statistic):} Utilizează percentila în locul mediei. Robust la interferențe, ignorând valorile extreme.
    
    \item \textbf{SOCA-CFAR (Smallest Of Cell Averaging):} Selectează minimul dintre mediile subregiunilor. Optim pentru separarea țintelor la marginile clutter-ului dens.
\end{itemize}

\begin{table}[H]
\centering
\small
\renewcommand{\arraystretch}{2.0}
\begin{tabular}{@{} l l l l l @{}}
\toprule
\textbf{Metodă} & \textbf{Robustețe clutter} & \textbf{Ținte slabe} & \textbf{Complexitate} & \textbf{Ideal pentru} \\ \midrule
CA & Scăzută & Ridicată & Foarte mică & Spectrograme omogene \\
OS & Foarte bună & Medie & Mare & Medii multi-target \\
SOCA & Bună & Medie & Medie & Margini clutter \\
\bottomrule
\end{tabular}
\caption{Comparație între metodele CFAR}
\end{table}

\subsection{Metode de clustering}

\begin{table}[H]
\centering
\small
\renewcommand{\arraystretch}{2.0}
\begin{tabular}{@{} l p{3.5cm} p{7.5cm} @{}}
\toprule
\textbf{Metodă} & \textbf{Descriere} & \textbf{Caracteristici} \\ \midrule

Agglomerative & 
Ierarhic bottom-up & 
Fuzionează succesiv perechile cele mai apropiate. Fiecare punct inițial = cluster. Unește până la K clustere. \\

HDBSCAN & 
Bazat pe densitate ierarhică & 
Folosește \textit{core distance} și \textit{MST}. Determină MRD: $d_{mrd}(u,v) = \max(c(u), c(v), d(u,v))$. Elimină clusterele sub \textit{min\_samples}. \\

DBSCAN & 
Bazat pe densitate & 
Grupeaza puncte cu distanță $\le \varepsilon$. Asymetric: $d = \sqrt{\Delta t^2 + (\Delta f / \text{freq\_scale})^2}$ optimizează pentru semnături verticale. \\
\bottomrule
\end{tabular}
\caption{Metode de clustering utilizate}
\end{table}

\subsection{Observații despre algoritmii de clustering}

\begin{itemize}
    \item \textbf{Agglomerative:} Lucrează prin proximitate directă. Nu elimină zgomotul, ceea ce poate duce la gruparea eronată a detecțiilor false CFAR în clustere valide.
    
    \item \textbf{HDBSCAN:} Utilizează \textit{Mutual Reachability Distance} pentru a penaliza punctele din zonele cu densitate mică. Elimină fenomenul de \textit{chaining} (unirea eronată a două ținte prin puncte de zgomot intermediare).
    
    \item \textbf{DBSCAN asimetric:} Țintele apar ca linii verticale în timp-frecvență (multe frecvențe, puține momente). Distanța asimetrică cu \texttt{freq\_scale=3.0} păstrează coeziunea țintelor.
\end{itemize}

\subsection{Experimente pe semnale sintetice controlate}

\textbf{Metodă 1: CA-CFAR + HDBSCAN}
\begin{itemize}
    \item STFT cu fereastră Hamming
    \item Detecție CA-CFAR pe spectrograma
    \item Clusterizare HDBSCAN a punctelor detectate
    \item Reconstrucție a componentei dominante
    \item Evaluare prin RQF (Reconstruction Quality Factor)
\end{itemize}

\textbf{Metodă 2: Separare prin Triangulare Delaunay}
\begin{itemize}
    \item STFT cu fereastră Gaussiană
    \item Detectarea maximelor locale peste prag percentilă
    \item Triangulare Delaunay în plan timp–frecvență
    \item Gruparea componentelor după energie
    \item Estimare Doppler din componenta cu energie maximă
\end{itemize}

\textbf{Rezultate sintetice:}
\begin{itemize}
    \item CA-CFAR + HDBSCAN: rate de detecție ridicate (100\%), RQF apropiate de articolul de referință, comportament stabil relativ la SNR. Confirmă validitatea CFAR cu ipoteza AWGN.
    \item Triangulare Delaunay: rezultate bune la SNR mediu și ridicat, dar variabilitate mai mare a RQF și sensibilitate crescută la pragul de detecție.
\end{itemize}

\section{Experimente pe IPIX cu ținte reale}

Am rulat detecție animată pe fișierele cu ținte reale. Figurile de mai jos arată cadre din animațiile de detecție:

\begin{figure}[H]
\centering
\includegraphics[width=0.95\textwidth]{../results/ipix_figures/ipix_target_17_goca_frame83.pdf}
\caption{Detecție GOCA-CFAR pe IPIX Target \#17 -- Cadru din animație arătând detecții active. Cele trei panouri arată: (stânga) spectrograma cu detecții acumulate (overlay roșu), (centru) heatmap de detecție, (dreapta) detecțiile cadrului curent. Linia verticală luminoasă reprezintă ținta plutitoare la Doppler pozitiv (se apropie de radar).}
\label{fig:goca_detection}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=0.95\textwidth]{../results/ipix_figures/ipix_target_17_fractal_frame83.pdf}
\caption{GOCA-CFAR cu Fractal Boost pe IPIX Target \#17 -- Cadru arătând detecții active. Fractal boost folosește analiza exponentului Hurst pentru a detecta ținte care perturbă structura self-similar a sea clutter, îmbunătățind detecția țintelor slabe.}
\label{fig:fractal_boost_detection}
\end{figure}

\subsection{Setul de Date și Scenarii}

Experimentele au fost realizate pe date radar reale din setul \textbf{IPIX} (McMaster University), caracterizate prin \textbf{clutter marin sever} și variații puternice de energie în timp și frecvență:

\begin{itemize}
    \item \textbf{Low Sea State} -- clutter moderat, detecție ușoară
    \item \textbf{High Sea State} -- clutter intens și neomogen, detecție dificilă
\end{itemize}

Semnalele sunt procesate segmentat (1 s), PRF = 1000 Hz, complexe I/Q.

\subsection{Rezultate comparative: CA-CFAR+HDBSCAN vs. Triangulare Delaunay}

\begin{table}[H]
\centering
\small
\begin{tabular}{@{} l c c c @{}}
\toprule
\textbf{Metodă} & \textbf{Sea State} & \textbf{Componente} & \textbf{Viteza [m/s]} \\ \midrule
\multirow{2}{*}{CA-CFAR + HDBSCAN} 
    & HIGH & $1.0 \pm 0.0$ & $-0.054$ \\
    & LOW  & $1.0 \pm 0.0$ & $-0.008$ \\ \midrule
\multirow{2}{*}{Triangulare Delaunay} 
    & HIGH & $4.2$ & $+1.30$ \\
    & LOW  & $13.6$ & $-0.30$ \\ 
\bottomrule
\end{tabular}
\caption{Performanță comparativă pe IPIX (30 segmente × 1s per scenariu)}
\end{table}

\subsection{Observații Experimentale Detaliate}

\textbf{CA-CFAR + HDBSCAN}:
\begin{itemize}
    \item \textbf{Rata de detecție}: 100\% (detectează în toate segmentele)
    \item \textbf{Problemă critică}: Detectează clutter masiv, nu ținta (variabilitate zero: $\sigma = 0$)
    \item HDBSCAN grupează întreg clutter-ul într-un cluster unic
    \item \textbf{Concluzie}: CA-CFAR nu poate separa ținta de clutter neomogen în mediu marin real
\end{itemize}

\textbf{Triangulare Delaunay}:
\begin{itemize}
    \item Rate de detecție ridicate, dar instabile și inconsistente
    \item HIGH sea: 4.2 componente; LOW sea: 13.6 componente (invers față de așteptat!)
    \item Viteza Doppler variază 4× între scenarii: +1.30 vs. -0.30 m/s
    \item Metoda geometrică fragmentează clutter-ul în componente multiple
    \item \textbf{Concluzie}: Instabilitate extremă, reducând consistența detecțiilor
\end{itemize}

\subsection{Concluzie validată experimental}

Pentru sea clutter real neomogen:

\begin{itemize}
    \item \textbf{CA-CFAR eșuează} -- detectează doar clutter, nu ținte (variabilitate zero)
    \item \textbf{Triangularea Delaunay} -- oferă detecție geometrică, dar instabilă (fragmentare excesivă)
    \item \textbf{GOCA-CFAR cu DBSCAN asimetric} (metoda din această implementare) -- **oferă performanța optimă** cu detecții stabile și consistent identificate
\end{itemize}

Motivul succesului GOCA + DBSCAN asimetric:
\begin{enumerate}
    \item GOCA-CFAR adaptează pragul local și pe 4 cadrane, nu doar global (CA)
    \item DBSCAN asimetric ($\text{freq\_scale}=3.0$) păstrează coeziunea țintelor (linii verticale în timp-frecvență)
    \item Combinația K-distribution + Hurst + DC masking + Doppler filter elimină alarmele false din clutter sever
\end{enumerate}


\label{chap:adaptations}

Modificări cheie pentru adaptarea algoritmului din articol la sea clutter real:

\section{Adaptarea 1: K-distribution}

\begin{equation}
p(x) = \frac{4}{\Gamma(\nu)} \left(\frac{\nu x^2}{2\mu}\right)^{(\nu+1)/2} K_{\nu-1}\left(\sqrt{\frac{2\nu x^2}{\mu}}\right)
\end{equation}

Sea clutter urmează K-distribution (cozi mai grele decât Gaussian). Estimare: $\nu = \mu^2 / (\sigma^2 - \mu^2)$. Ajustare prag pentru reducerea alarmelor false.

\section{Adaptarea 2: Exponentul Hurst}

\begin{equation}
\mathbb{E}\left[|X(t+\tau) - X(t)|^2\right] \propto \tau^{2H}
\end{equation}

Sea clutter: $H \approx 0.75$--$0.85$; ținte: $H < 0.6$. Mască combinată: $\text{CFAR} \lor (\text{Hurst anomaly} \land \text{putere mare})$ pentru detecție ținte slabe.

\section{Adaptarea 3: DBSCAN asimetric pentru semnături verticale}

Țintele apar ca \textbf{linii verticale} (multe frecvențe, puține momente). DBSCAN standard fragmentează acestea în clustere multiple.

\textbf{Soluție}: Distanță asimetrică }

Distanță asimetrică: $d = \sqrt{\Delta t^2 + (\Delta f / 3)^2}$ cu \texttt{freq\_scale=3.0}. Ținte pe 50 bin-uri frecvență $\rightarrow$ 1valuri.

\textbf{Soluție}: Mascăm $\pm DC}

Mască $\pm 8$ bin-uri frecvență în jurul DC înainte de CFAR (returnări staționare non-ținte)

\textbf{Soluție}: Respingem cDoppler}

Respingem clustere cu bandwidth Doppler $< 3$ Hz (detecții fizic implauzibile)============
\chapter{Detalii de implementare}

\section{Parametri și calibrare}

\begin{table}[H]
\centering
\caption{Parametrii algoritmului -- valori utilizate}
\begin{tabular}{lccc}
\toprule
\textbf{Parametru} & \textbf{Valoare} & \textbf{Interval} & \textbf{Semnificație} \\
\midrule
$N_{fft}$ (window\_size) & 256 & $[128, 512]$ & Lungime FFT \\
$H$ (hop\_size) & 32 & $[N/8, N/2]$ & Hop = 87.5\% overlap \\
$\sigma_{window}$ & 8 & [4, 16] & Deviația std. a ferestrei \\
$P_{fa}$ & 0.001 & [0.0001, 0.01] & Probabilitate alarmă falsă \\
$N_G$ (cfar\_guard) & 3 & [2, 8] & Mărime celule guard \\
$N_T$ (cfar\_training) & 12 & [8, 24] & Mărime celule training \\
$\varepsilon_{DBSCAN}$ & 8 & [4, 16] & Raza de clustering \\
minSamples & 5 & [3, 10] & Puncte minime per cluster \\
freq\_scale & 3.0 & [2, 5] & Scalare DBSCAN asimetric \\
dc\_mask\_bins & 8 & [4, 16] & Bin-uri DC de mascat \\
min\_doppler\_bw & 3.0 Hz & [1, 10] & Lățime Doppler minimă \\
\bottomrule
\end{tabular}
\end{table}

\section{Notă asupra Doppler}

Conversie: $v_r = \frac{f_d \cdot c}{2 f_{RF}}$. Pentru IPIX ($f_{RF} = 9.39$ GHz), $f_d = +100$ Hz $\rightarrow$ $v_r \approx +1.6$ m/s; viteza max neambiguă $\approx \pm 8$ m/s.

% ============================================================================
% CAPITOLUL 8: CONCLUZII
% ============================================================================
\chapter{Concluzii și direcții viitoare}

\section{Concluzii}

Implementarea CFAR-STFT demonstrează: (1) RQF = 29.17 dB @ SNR=30dB cu 100\% detecție pe sintetice; (2) performance consistentă pe 100 MC runs; (3) validare pe date IPIX reale cu sea clutter complex; (4) reproductibilitate via GitHub.

\section{Direcții viitoare}

GPU acceleration, auto-calibration, sistem operațional, multi-target tracking, ML-based parameter adaptation.

\section{Cod}

GitHub: \url{https://github.com/dirgnic/Radar_Detection_STFT} (reproductibilitate, replicare independentă).

\begin{thebibliography}{99}

\bibitem{abratkiewicz2022}
Abratkiewicz, K. (2022).
\textit{Radar Detection-Inspired Signal Retrieval from the Short-Time Fourier Transform}.
Sensors, 22(16), 5954.
\newline \url{https://doi.org/10.3390/s22165954}

\bibitem{ipix}
S. Haykin, et al.,
``IPIX Radar Database,''
McMaster University / DREO, 1993.
\url{http://soma.ece.mcmaster.ca/ipix/}

\bibitem{ward2006}
K. D. Ward, R. J. A. Tough, S. Watts,
\textit{Sea Clutter: Scattering, the K Distribution and Radar Performance},
IET, 2006.

\bibitem{hurst1951}
H. E. Hurst,
``Long-term storage capacity of reservoirs,''
\textit{Trans. Am. Soc. Civil Eng.}, vol. 116, pp. 770-799, 1951.

\bibitem{harris1978}
Harris, F.J. (1978).
\textit{On the Use of Windows for Harmonic Analysis with the Discrete Fourier Transform}.
Proceedings of the IEEE, 66(1), 51-83.

\bibitem{ester1996}
Ester, M., Kriegel, H.-P., Sander, J., Xu, X. (1996).
\textit{A Density-Based Algorithm for Discovering Clusters in Large Spatial Databases with Noise}.
In KDD'96: Proceedings, pp. 226-231.

\bibitem{rohling1983}
H. Rohling,
``Radar CFAR thresholding in clutter and multiple target situations,''
\textit{IEEE Trans. Aerospace Electron. Syst.}, vol. 19, no. 4, 1983.

\bibitem{richards2005}
Richards, M. A. (2005).
\textit{Fundamentals of Radar Signal Processing}.
McGraw-Hill Professional.

\end{thebibliography}

\end{document}
